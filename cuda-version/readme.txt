не Первая версия решётки
работает на ГП
оптимизации выполнены
не проверял результат